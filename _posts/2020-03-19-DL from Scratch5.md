---
layout: post
title: 5. 학습 관련 기술들
category: DL from Scratch
tag: Deep-Learning
---



## 1) 매개변수 갱신

- **최적화(Optimization)** : 신경망 학습의 목적은 손실 함수의 값을 최대한 낮추는 매개변수를 찾는 것. 이런 문제를 푸는 것을 **최적화** 라고 한다. 



- **확률적 경사 하강법(SGD)** : 앞에서 구현했던 미분값을 통해 더 나은 파라미터 값으로 개선하는 방법을 확률적 경사하강법이라고 하며 수식으로는 다음과 같이 나타낼 수 있다.

$$
\mathbf{W}_{\text{new}} = \mathbf{W}_{\text{old}} - \eta \frac{\partial{L}}{\partial{\mathbf{W}}}
$$

위 수식에서 볼 수 있듯, SGD는 기울어진 방향으로 일정한 거리만큼만 가겠다는 방법이다. 이를 파이썬 코드로 구현하면 다음과 같이 나타낼 수 있다.

```python
class SGD:
    def __init__(self, lr=0.01):
        self.lr = lr

    def update(self, params, grads):
        for key in params.keys():
            params[key] -= self.lr * grads[key]
```

SGD는 직관적이고 구현하기도 쉽지만, 비등방성(방향에 따라 성질이 달라지는) 함수 등에서는 탐색 경로가 비효율적으로 주어진다는 단점을 가지고 있다. 다음으로 등장할 모멘텀(Momentum),  Adagrad, Adam 등은 SGD의 단점을 개선하기 위한 Optimizer들이다.



- **모멘텀(Momentum)** : 모멘텀의 사전적 정의는 '운동량'이며, 모멘텀은 그래디언트의 변화가 심한 경우에는 더 빠르게 값을 개선하며, 그래디언트가 변화가 더딘 구간에서는 더 정교하게 값을 개선해나간다. 모멘텀의 수학적 수식을 살펴보자.

$$
\mathbf{v}_{\text{new}} = \alpha \mathbf{v}_{\text{old}} - \eta \frac{\partial{L}}{\partial{\mathbf{W}}} \\
{\mathbf{W}}_{\text{new}} = {\mathbf{W}}_{\text{old}} + {\mathbf{v}} \\ \text{ } \\ 
{\mathbf{v}} : \text{속도, } \alpha : {\mathbf{v}} \text{를 조정하기 위한 하이퍼파라미터}
$$

아래는 모멘텀을 파이썬 코드로 나타낸 코드이다.

```python
class Momentum:
    def __init__(self, lr=0.01, momentum=0.9):
        self.lr = lr
        self.momentum = momentum
        self.v = None

    def update(self, params, grads):
        if self.v is None:
            self.v = {}
            for key, val in params.items():
                self.v[key] = np.zeros_likes[val]

        for key in params.keys():
            self.v[key] = self.momentum * self.v[key] - self.lr * grads[key]
            params[key] += self.v[key]
```



- **Adagrad** : 지금까지는 고정된 학습률을 사용했다면 지금부터는 **학습률 감소(Learning Rate Decay)** 라는 기법을 사용하여 학습률도 개선해나간다. Adagrad의 수식을 살펴보자.

$$
\mathbf{h}_{\text{new}} = \mathbf{h}_{\text{old}} + \frac{\partial{L}}{\partial{\mathbf{W}}} \odot \frac{\partial{L}}{\partial{\mathbf{W}}} \\
{\mathbf{W}}_{\text{new}} = {\mathbf{W}}_{\text{old}} - \eta \frac{1}{\sqrt{\mathbf{h}}} \frac{\partial{L}}{\partial{\mathbf{W}}} \\ \text{ } \\ 
{\mathbf{h}} : \text{기울기 값의 제곱을 계속 더해준 값}
$$

Adagrad 에서 개선된 $\mathbf{W}$ 는 그래디언트에 단순히 학습률만을 곱하여 수정하는 것이 아니라, 학습률에 $\frac{1}{\sqrt{h}}$ 를 곱한 값에 그래디언트를 곱하여 $\mathbf{W}$ 를 개선해나간다. Adagrad를 파이썬 코드로 구현하면 아래와 같다.

```python
class Adagrad:
    def __init__(self, lr=0.01):
        self.lr = lr
        self.h = None

    def update(self, params, grads):
        if self.h is None:
            self.h = {}
            for key, val in params.items():
                self.h[key] = np.zeros_likes[val]

        for key in params.keys():
            self.h[key] += grads[key] * grads[key]
            params[key] -= self.lr * grads[key] / (np.sqrt(self.h[key]) + 1e-7)
```



- **Adam** : 모멘텀의 방법(그래디언트 조정법)과 Adagrad(학습률 조정법)을 융합한 방법.
-  어떤 갱신 방법(Optimizer, 옵티마이저)를 선택할 것인가? 모델마다 다르고, 하이퍼파라미터 설정에 따라 또 달라진다. 보통은 Adam을 많이 사용. 여러 가지로 시도해 볼 것.




<br/>

## 2) 가중치의 초깃값

- 초깃값을 0으로 하면? 안된다. 정확히는 초깃값을 **동일하게 설정하면 안된다.** 초깃값이 동일하면 오차역전파를 통해 개선되는 가중치의 값이 모두 같아지기 때문이다. 이런 현상을 미연에 방지하기 위해 초깃값을 무작위(예를 들어, 정규분포) 값으로 설정한다.



- 은닉층의 활성화 값 분포 : 은닉층의 활성화 값(활성화 함수의 출력 값) 분포를 관찰하면 중요한 정보를 얻을 수 있다. 책에서는 활성화 함수로 시그모이드 함수를 사용하는 5층 신경망에 무작위한 데이터를 흘린 뒤, 각 층의 활성화값 분포를 알아본다.

```python
import numpy as np
import matplotlib.pyplot as plt

def sigmoid(x):
    return 1 / (1 + np.exp(-x))

x = np.random.randn(1000, 100)  # 100개의 특성으로 이루어진 1000개의 데이터 생성
node_num = 100      # 은닉층의 노드 수
hidden_layer_size = 5   #은닉층의 수
activations = {}    # 활성화 값을 저장

for i in range(hidden_layer_size):
    if i != 0:
        x = activations[i-1]
    w = np.random.randn(node_num, node_num) * 1     # 임의의 가중치 생성
    a = np.dot(x, w)    # 가중치와 데이터의 곱
    z = sigmoid(a)
    activations[i] = z  # 곱한 값을 활성화 함수에 넣어 도출된 활성화 값을 저장
    
# 히스토그램 그리기
for i, a in activations.items():
    plt.subplot(1, len(activations), i+1)
    plt.title(str(i+1) + "-layer")

    if i != 0:
        plt.yticks([], [])
    plt.hist(a.flatten(), 30, range=(0,1))
plt.show()
```

위 코드를 실행하면 다음과 같은 히스토그램이 출력된다.

![sigmoid1](data:image/png;base64,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%0A)

위 층의 활성화 값은 대부분 0 또는 1의 값에 편중되어 있다. 위 코드에서 사용한 활성화 함수가 시그모이드 함수이기 때문에 활성화 값이 0 또는 1에 가까워질수록 그 지점에서의 미분값은 0에 가까워진다. 때문에 층이 깊어질수록 역전파의 기울기 값이 점점 작아지다가 사라진다. 이를 **기울기 소실(Gradient Vanishing)** 이라한다. 그렇다면 활성화 값이 0과 1로 편중되지 않도록 가중치의 표준편차를 줄이면 어떻게 될까? 아래는 가중치 표준편차를 0.01로 바꾼 뒤 히스토그램을 그린 것이다.

```python
w = np.random.randn(node_num, node_num) * 0.01	# 1에서 0.01로 표준편차를 바꾼다.
```

![sigmoid0.01](data:image/png;base64,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%0Af/rOiznprSsvcy0nMPn/P3M5J7CHvMyKU0b9qqq1wNruWJLBqlo+Q0PaJ/Z2n7r/kedaXszJaJPZ%0An5G8zLWcwOR/V+ZzTmbLKaOdwFFdy4taTJI0TWZLQdgKLElydJKDgNOATTM8JkmaV2bFKaOqeibJ%0A2cDVwAJgXVVt67P72vGb7HemYp/mWl7MyWjmpLfJ7tO8zcmsuKgsSZp5s+WUkSRphlkQJEnAfl4Q%0A5tqfu0iyLsmDSW6bxDbMyehtmJPe2zEvo7cxv3NSVfvlROfi898CvwEcBPwQWDrT45rkPr0ZeD1w%0AmzkxJ/sqJ+bFnIw17c9HCHPuz11U1XeBXZPYhDkZzZz0Zl5Gm/c52Z8LwkJge9fyjhabz8zJaOak%0AN/My2rzPyf5cECRJU2h/Lgj+uYvRzMlo5qQ38zLavM/J/lwQ/HMXo5mT0cxJb+ZltHmfk/22IFTV%0AM8DIn7u4A9hY/f+5i1kpyVeB7wOvTLIjyZkT6W9ORjMnvZmX0cyJf7pCktTst0cIkqSpZUGQJAEW%0ABElSY0GQJAEWBElSY0GQJAEWBElS8/8BxF2J5heXbKMAAAAASUVORK5CYII=%0A)

이번에는 거의 모든 값이 가운데, 즉 0.5에 가까이 있다. 이것은 거의 모든 뉴런이 같은 값을 출력하고 있다는 의미이므로, 100개나 되는 뉴런의 효용성이 떨어진다고 볼 수 있다. 그렇다면 **Xavier 초깃값** 을 써보자. Xavier 초깃값은 앞 층의 노드가 $n$ 개일 때, 가중치의 표준편차를 $\frac{1}{\sqrt{n}}$ 이 되도록 하는 것이다.

```python
w = np.random.randn(node_num, node_num) * np.sqrt(1.0 / node_num)
# Xavier 초깃값 식에 맞도록 가중치 표준편차를 수정해준다.
```

![SigmoidXavier](data:image/png;base64,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%0Ax7Zt20bdjWWX5K6FbN9DXazJzBZSF2synTVxekeSumLoS1JHDH1J6oihL0kdMfQlqSOGviR1xNCX%0ApI4Y+pLUEUNfkjpi6Dfrzr2adedePe3xcFvvrMfceq1Rr+c9l3GsyVh/DMMojOMvadxM1ejOC04d%0AcU8kLZQjfUnqiKGPo3tJ/TD0NafZ5mt7e7J03nphrNd46npO3z9ISb1xpC9JHTH0JakjXU7vLHRa%0Ax1sUJU2KeY30k9yZ5FtJvplkW2t7TpKtSW5r3w9t7UnykSTbk9yU5FVDx9nYtr8tycblOSVpeXmB%0AUqvZQqZ3fqWqXlFVG9rjc4Frqmo9cE17DHAysL59bQIuhMGTBHAecCxwDHDe1BOFJGllLGZO/zRg%0AS1veApw+1P7xGvg6cEiS5wInAlurandV3Q9sBU5axM/XCnBEK02W+YZ+Af87yQ1JNrW2w6vqe235%0AHuDwtrwW2DG0787WNlv7UyTZlGRbkm27du2aZ/ckSfMx3wu5v1RVdyf5OWBrkr8cXllVlaSWokNV%0AtRnYDLBhw4YlOaYkaWBeI/2qurt9vw/4PIM5+XvbtA3t+31t87uBI4d2P6K1zdYuSVohc4Z+kp9J%0A8sypZeAE4NvAlcDUHTgbgSva8pXA29tdPMcBD7ZpoC8BJyQ5tF3APaG1SZJWyHymdw4HPp9kavtP%0AVdWfJLkeuDzJWcBdwBlt+y8CpwDbgUeAdwBU1e4k7wOub9udX1W7l+xMJElzmjP0q+p24OUztP8A%0AOH6G9gLOnuVYFwMXL7ybkqSl4McwLIBvypG02nX1MQwGtqTeOdKXpI4Y+pLUEUNfkjpi6EtSRwx9%0ASeqIob8PvHXzSdZCWl26CX2DSZI6Cn1JUmdvztL8+cpoYayXVgtH+pK0gkZ9HczQl6SOGPqS1BFD%0AX5I6YuhLUkcMfUnqiKEvSR0x9CWpI4b+IviGHEmrjaEvSR0x9CWpI4a+tBdO4WnS+IFregpDTpps%0AEx/6hpgkPcnpHUnqiKEvaVmN+qOE9VQTP70jLZaBpUniSF+SOmLoS1JH5h36SfZLcmOSq9rjo5Jc%0Al2R7ksuSHNjan94eb2/r1w0d4z2t/dYkJy71yUiS9m4hI/13ArcMPf4g8KGqehFwP3BWaz8LuL+1%0Af6htR5KjgTOBlwEnAX+QZL/FdV+StBDzCv0kRwCnAh9rjwO8HvhM22QLcHpbPq09pq0/vm1/GnBp%0A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%0A)

층이 깊어지면서 모양이 변형되기는 하지만, 이전보다 훨씬 더 나은 활성값 분포를 보이는 것을 알 수 있다.

 

- ReLU를 사용할 때의 가중치 초깃값 : ReLU 함수를 활성화 값으로 사용할 때는 추천되는 초깃값이 따로 있다. 이 때의 초깃값을 **He 초깃값** 이라고 하며, He 초깃값은 앞 층의 노드가 $n$ 개일 때, 가중치의 표준편차를 $\frac{2}{\sqrt{n}}$ 이 되도록 하는 것이다. 아래는 각각 Xavier 초깃값과 He 초깃값을 넣었을 때의 활성화 값 분포를 히스토그램으로 그린 것이다.

  - Xavier 초깃값으로 하였을 때 : 아래 그래프를 보면 첫 번째 층에서는 활성화 값이 골고루 분포되어 있지만, 층을 거쳐갈수록 한 쪽으로 분포가 치우치는 것을 알 수 있다. 이렇게 되면 층이 깊어졌을 때에는 다시금 Gradient Vanishing 문제가 발생하게 된다.

  ![ReLUXavier](data:image/png;base64,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%0A)

  - He 초깃값으로 하였을 때 : 이 경우에는 층을 계속 거치더라도 활성화 값들의 분포가 크게 변하지 않는 것을 볼 수 있다. 때문에 활성화 함수가 ReLU일 때는 He 초깃값을 사용하며, Sigmoid나 tanh일 때는 Xavier 초깃값을 사용하는 것이 일반적이다.

  ![ReLU](data:image/png;base64,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%0A)



<br/>

## 3) 배치 정규화

- 배치 정규화가 주목받는 이유
  - 학습을 빠르게 진행할 수 있다
  - 초깃값에 크게 의존하지 않는다
  - 오버피팅을 억제한다



- 배치 정규화의 기본 아이디어는 각 층에서 활성화 값이 적당히 분포되도록 **배치 정규화(Batch Norm)** 계층을 신경망에 삽입하는 것이다. 배치 정규화 계층에서는 학습 시 미니배치를 한 단위로 하여 정규화를 진행하며, 데이터 분포의 평균이 0이고 분산이 1이 되도록 조정한다. 또, 배치 정규화 계층마다 정규화된 데이터에 추가 작업(확대, 이동 변환)을 수행할 수 있다. 정규화와 변환을 수식으로 나타내면 다음과 같다.

  - 정규화

  $$
  \text{미니배치 } B = [x_1, x_2, ..., x_m] \text{ 일 때,} \\
  \mu_B = \frac{1}{m}\sum^m_{i=1}x_i \\
  \sigma^2_B = \frac{1}{m}\sum^m_{i=1}(x_i-\mu_B)^2 \\
  x_i \leftarrow \frac{x_i - \mu_B}{\sqrt{\sigma^2_B + \epsilon}}
  $$

  - 변환

  $$
  y_i \leftarrow \gamma \hat{x_i} + \beta \\
  \gamma \text{ : 확대} \quad \beta \text{ : 변환}
  $$



<br/>

## 4) 바른 학습을 위해

- **오버피팅(Overfitting, 과적합)** : 신경망 모델이 훈련 데이터에 지나치게 적응되어 그 외의 데이터에는 제대로 적용되지 못하는 상태를 말한다.  
  - 오버피팅이 일어나는 경우 : 매개 변수(특성)가 많고 표현력이 높은 모델일 때, 훈련 데이터가 적을 때



- **가중치 감소(Weight Decay)** : 가중치 감소는 오버피팅을 막기 위한 첫 번째 방법이다. 손실 함수를 줄이는 것이 학습의 목적이기 때문에 손실 함수에서 나오는 값에 가중치 값을 변형하여 더해주게 되면 가중치가 커지는 것을 막을 수 있다.
  - **L2 Norm** (가중치의 제곱 노름)을 더하는 방식. 손실 함수의 값에 $\frac{1}{2}\lambda\mathbf{W}^2$ 을 더해준다. 여기서 $\lambda$ 는 감소의 정도를 정하기 위한 것으로 값이 클수록 가중치 값이 더 큰 페널티를 받게 된다.
  - **L1 Norm** (가중치의 절댓값 노름)을 더하는 방식. 손실 함수의 값에 $\lambda \abs{\mathbf{W}}$ 를 더해준다.



- **드롭아웃(Dropout)** : 오버피팅을 막기 위한 두 번째 방법은 드롭아웃이다. 신경망이 복잡해질 경우 가중치 감소만으로는 오버피팅을 막기 힘들다. 때문에 드롭아웃이라는 기법을 사용한다. 드롭아웃은 임의의 뉴런을 삭제하는 방법이다. 아래는 드롭아웃을 구현하기 위한 파이썬 코드이다. 

```python
class Dropout:
    def __init__(self, dropout_ratio=0.5):
        self.dropout_ratio = dropout_ratio
        self.mask = None
        # dropout의 비율을 정해준다.

    def forward(self, x, train_flg=True):
        if train_flg:
            self.mask = np.random.rand(*x.shape) > self.dropout_ratio
            return x * self.mask
        	# (0,1)범위의 x.shape과 동일한 벡터를 생성하고
            # dropout_ratio보다 큰 것만 True로 반환하여 데이터와 연산
        else:
            return x * (1.0 - self.dropout_ratio)

    def backward(self, dout):
        return dout * self.mask
```



<br/>

## 5) 적절한 하이퍼파라미터 찾기

- **검증 데이터(Validation Data)** : 지금까지는 모델 자체를 평가하기 위하여 훈련과 시험 데이터 세트로만 나누었다. 하지만 앞으로 진행할 하이퍼파라미터 최적화를 위해서는 하나의 데이터셋을 추가로 확보해야 한다. 시험 데이터를 하이퍼파라미터 최적화에 사용하면 최적화 이후에 모델을 평가할 데이터 세트가 없기 때문이다. 이 때 추가로 확보하는 데이터를 검증 데이터라고 한다.



- **하이퍼파라미터 최적화(Hyperparameter Optimization)** : 하이퍼파라미터를 최적화할 때의 핵심은 하이퍼파라미터의 최적 값이 존재하는 범위를 조금씩 줄여나가는 것[^1]이다. 대개 $10^n$ 형태의 로그 스케일로 범위를 정하며, 여러 값을 테스트 하면 시간이 오래 걸리게 된다. 따라서, 학습 시간을 줄이기 위하여 에포크를 작게 한다.
  1. 하이퍼파라미터 값의 범위 설정하기
  2. 설정된 범위에서 하이퍼파라미터의 값을 무작위로 추출
  3. 추출된 하이퍼파라미터 값을 검증 데이터로 평가
  4. 위 과정을 정해진 횟수만큼 반복하여, 정확도의 결과를 보고 범위를 줄여나간다.



[^1]: 신경망의 하이퍼파라미터 최적화에서는 그리드 서치(Grid Search) 같은 규칙적인 탐색보다는 무작위로 샘플링해 탐색하는 편이 좋은 결과를 낸다고 알려져 있다.