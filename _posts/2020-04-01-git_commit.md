---
layout: post
title: Git (2)
category: Git
tag: Git
---



본 포스트의 내용은 [깃 교과서, 이호진, 길벗, 2020](http://www.yes24.com/Product/Goods/89522012) 을 참고하여 작성하였습니다.



# 커밋 (Commit)

## 파일 관리 방법

- 깃 없이 원래 하던대로 파일의 버전관리를 할 때 벌어지는 현상

```
프로젝트_최종.ppt
프로젝트_마지막.ppt
프로젝트_진짜마지막.ppt
프로젝트_진짜진짜최종.ppt
프로젝트_진짜최종마지막임.ppt
프로젝트_진짜진짜끝_더는없음.ppt
```

수정한 부분 이외에도 파일의 모든 내용이 중복되기 때문에 용량을 많이 차지하게 된다.



- 깃으로 파일을 관리한다면

```
프로젝트_최종.ppt (커밋1 - 커밋2 - 커밋3 - 커밋4 - 커밋5 - 커밋6)
```

커밋은 파일의 수정된 부분만을 저장한다. 즉 저장된 파일은 하나지만 언제 어디가 수정되었는지를 커밋으로 저장하게 된다. 마지막 수정(커밋 6)을 한 이후에도 언제든 이전 커밋(예를 들면, 커밋 4)으로 돌아갈 수 있다.



- 헤드와 스냅샷
  - **헤드(HEAD)** : 최종 커밋 작업의 위치를 가리키는 포인터. 깃이 새로 생성되었을 때는 존재하지 않는다. 한 번 이상 커밋하면 맨 마지막 커밋을 따라 Head가 이동하게 된다.
  - 스냅샷(Snapshot) : 깃이 파일의 수정 사항만을 저장하는 방식. HEAD가 가리키는 커밋(즉, 마지막 커밋)을 기반으로 Stage의 파일과 비교하여 수정 사항을 기록한다.



## 새 파일 부터 커밋까지

- 파일 생성 후 **상태 확인** 하기 : 깃이 있는 폴더 내에 새로운 파일을 생성하면 기본적으로 Untracked 상태가 된다. 이것을 `status` 명령어로 확인할 수 있다.

```bash
$ git status
```



- **스테이지에** **올리기** 혹은 내리기 : Untracked 상태에 있는 파일은 add 명령어로 Tracked 상태로 올릴 수 있다. 실수로 Tracked 시킨 파일이 있다면 `rm` 이나 `reset` 명령어를 통해 Untracked 상태로 내릴 수 있다.

```bash
# Tracked 상태로 만들기
$ git add <명령어>
# <명령어> 에는 주로 파일 이름이 들어간다. 모든 파일을 추가하고 싶을 때는 * 혹은 . 를 입력하면 된다. 

# Untracked 상태로 만들기
$ git rm --cached <명령어>		# 한 번도 커밋한 적이 없는 경우
$ git reset <명령어>			# 한번 이상 커밋을 한 파일의 경우
```



- **커밋(Commit)하기** : Untracked 상태의 파일은 커밋할 수 없다. 그렇기 때문에 커밋하기 이전에는 원하는 파일들이 모두 Tracked 상테에 있는지를 `status` 명령어를 통해 확인해주는 것이 좋다. 원하는 파일이 모두 Tracked 상태가 되었다면 `commit` 명령어를 통해 파일을 커밋할 수 있다.

  ```bash
  $ git commit
  ```

  - 커밋 메시지 : 변경 사항을 쉽게 볼 수 있도록 남기는 메시지. 남이 알아볼 수 있도록 작성하는 것이 좋다. 아래의 명령어를 이용해 커밋 메시지를 입력할 수 있으며, `-m` 대신 `vi` 에디터를 이용하여 작성하는 것도 가능하다.

  ```bash
  $ git commit -m <메시지>
  
  # 커밋 메시지를 작성하고 싶지 않다면?
  $ git commit --allow-empty-message -m ""
  # 방금 작성한 커밋 메시지를 수정하고 싶다면
  $ git commit --amend -m <메시지>
  ```

  - 커밋 이전에 파일을 `add` 로 워킹 디렉터리를 정리해놓지 않으면 제대로 커밋이 진행되지 않는다. 때문에 깃은 하나의 명령어로 `add`  와 `commit` 을 동시에 수행할 수 있도록 하는 명령어를 제공한다. 아래 명령어를 사용하면 두 과정을 한꺼번에 수행할 수 있다.

  ```bash
  $ git commit -a		# 커밋 메시지는 에디터로 작성
  $ git commit -am <메시지>	# 터미널에서 커밋 메시지 작성
  ```



- 커밋 완료 및 커밋 로그(기록) 확인하기

  - 커밋이 완료된 후 `git status` 를 입력하여 워킹 디렉터리의 상태를 볼 수 있다. `working tree clean` 메시지가 뜬다면 커밋이 제대로 완료된 것.
  - 터미널에서 아래의 명령을 통해 커밋 로그를 볼 수 있다.

  ```bash
  $ git log
  ```



- 파일을 잘못 수정하였다면 `checkout` 명령어를 활용하여 이전 커밋으로 되돌릴 수 있다.

```bash
$ git checkout -- <파일이름>
```



- 커밋 아이디 : 각 커밋마다 붙어있는 복잡한 숫자와 영어 조합. 특정 커밋을 구분하기 위해 있는 키이다. SHA1 이라는 해시 알고리즘을 사용하여 작성되며, 총 40자리의 16진수로 구성되어 있다. 커밋 아이디를 활용하면 특정 커밋의 상세 정보(변경 사항 등)를 볼 수 있다.

```bash
$ git log	# 를 통하여 특정 커밋의 ID을 확인한 뒤
$ git show <커밋ID>	# 를 활용하면 커밋의 상세 정보를 볼 수 있다.
```



- `diff` 명령어 : 워킹 디렉터리와 스테이지 영역의 차이(difference)를 확인할 수 있는 명령어이다. 예를 들어, 특정 파일을 수정한 뒤 modified 상태로 두고 `diff`  명령어를 입력하면 수정 사항을 보여준다. 워킹 디렉터리와 스테이지 영역을 비교하므로 `add` 명령어를 통해 해당 파일을 Stage 영역으로 올려준 뒤에는 `diff` 명령어를 입력하면 아무것도 출력되지 않는다.
  대신 `diff head` 명령어를 사용하면 마지막 커밋과 스테이지 영역의 차이점을 확인할 수 있다.

```bash
$ git diff		# 워킹 디렉터리와 스테이지 영역을 비교
$ git diff head	# 스테이지 영역과 마지막 커밋(HEAD)을 비교 
```



<br/>

